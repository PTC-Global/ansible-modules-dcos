- hosts: localhost
  tasks:
    - name: Get DCOS credentials
      dcos_facts:
    - debug: msg="{{ dcos_credentials }}"

    - name: create a first test user
      dcos_user:
        uid: test-user-dcos1
        password: "L4m3Password"
        description: "Group Test User 1"
        state: present
        dcos_credentials: "{{ dcos_credentials }}"
      register: result
    - debug: var=result

    - name: create a second test user
      dcos_user:
        uid: test-user-dcos2
        password: "L4m3Password"
        description: "Group Test User 2"
        state: present
        dcos_credentials: "{{ dcos_credentials }}"
      register: result
    - debug: var=result

    - name: create a group containing the test users
      dcos_group:
        gid: test-group-dcos
        description: "The Amazing Group of Awesomeness"
        users:
          - test-user-dcos1
          - test-user-dcos2
        state: present
        dcos_credentials: "{{ dcos_credentials }}"
      register: result
    - debug: var=result

    - name: remove the newly created group
      dcos_group:
        gid: test-group-dcos
        state: absent
        dcos_credentials: "{{ dcos_credentials }}"

    - name: remove first test user
      dcos_user:
        uid: test-user-dcos1
        state: absent
        dcos_credentials: "{{ dcos_credentials }}"

    - name: remove second test user
      dcos_user:
        uid: test-user-dcos2
        state: absent
        dcos_credentials: "{{ dcos_credentials }}"
